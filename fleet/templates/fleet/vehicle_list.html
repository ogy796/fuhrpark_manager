{% extends 'base.html' %}

{% block content %}

<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h1 class="h2 mb-1">Fahrzeugübersicht</h1>
        <p class="text-muted">Verwalten Sie Ihre gesamte Flotte.</p>
    </div>
    
    <form method="GET" action="" class="d-flex" style="max-width: 300px;">
        <input type="text" 
               name="q" 
               class="form-control me-2" 
               placeholder="Suchen..." 
               value="{{ request.GET.q|default_if_none:'' }}">
        <button class="btn btn-primary" type="submit">Go</button>
        {% if request.GET.q %}
            <a href="{% url 'vehicle_list' %}" class="btn btn-light ms-2 text-danger">&times;</a>
        {% endif %}
    </form>
</div>

<div class="card">
    <div class="card-body p-0">
        <table class="table table-hover align-middle mb-0">
            <thead class="bg-light">
                <tr>
                    <th class="ps-4">Kennzeichen</th>
                    <th>Fahrzeug</th>
                    <th>Fahrer</th>
                    <th>Service</th>
                    <th class="text-end pe-4">Aktion</th>
                </tr>
            </thead>
            <tbody>
                {% for vehicle in trucks %}
                <tr>
                    <td class="ps-4 fw-bold text-dark">
                        {{ vehicle.license_plate }}
                    </td>
                    
                    <td>
                        <div class="fw-medium text-dark">{{ vehicle.brand_model }}</div>
                        <div class="small text-muted">BJ: {{ vehicle.year_of_manufacture }}</div>
                    </td>
                    
                    <td>
                        {% if vehicle.driver %}
                            <span class="badge bg-primary-subtle text-primary border border-primary-subtle">
                                {{ vehicle.driver.first_name }} {{ vehicle.driver.last_name }}
                            </span>
                        {% else %}
                            <span class="badge bg-secondary-subtle text-secondary">Frei</span>
                        {% endif %}
                    </td>
                    
                    <td>
                        {% if vehicle.last_service %}
                            {{ vehicle.last_service|date:"d.m.Y" }}
                        {% else %}
                            <span class="text-muted small">–</span>
                        {% endif %}
                    </td>
                    
                    <td class="text-end pe-4">
                        <a href="{% url 'vehicle_detail' vehicle.pk %}" class="btn btn-sm btn-outline-secondary">
                            Öffnen
                        </a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5" class="text-center py-5 text-muted">
                        Keine Fahrzeuge gefunden.
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <div class="card-footer bg-white border-top text-muted small ps-4">
        Gesamt: {{ trucks|length }} Fahrzeuge
    </div>
</div>

{% endblock %}